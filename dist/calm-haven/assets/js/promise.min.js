!function(k){function g(){}function q(a,c){return function(){a.apply(c,arguments)}}function d(a){if("object"!=typeof this){throw new TypeError("Promises must be constructed via new")}if("function"!=typeof a){throw new TypeError("not a function")}this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],v(a,this)}function h(a,c){for(;3===a._state;){a=a._value}return 0===a._state?void a._deferreds.push(c):(a._handled=!0,void d._immediateFn(function(){var f=1===a._state?c.onFulfilled:c.onRejected;if(null===f){return void (1===a._state?b:p)(c.promise,a._value)}var n;try{n=f(a._value)}catch(e){return void p(c.promise,e)}b(c.promise,n)}))}function b(f,o){try{if(o===f){throw new TypeError("A promise cannot be resolved with itself.")}if(o&&("object"==typeof o||"function"==typeof o)){var a=o.then;if(o instanceof d){return f._state=3,f._value=o,void j(f)}if("function"==typeof a){return void v(q(a,o),f)}}f._state=1,f._value=o,j(f)}catch(c){p(f,c)}}function p(a,c){a._state=2,a._value=c,j(a)}function j(c){2===c._state&&0===c._deferreds.length&&d._immediateFn(function(){c._handled||d._unhandledRejectionFn(c._value)});for(var f=0,a=c._deferreds.length;f<a;f++){h(c,c._deferreds[f])}c._deferreds=null}function l(c,f,a){this.onFulfilled="function"==typeof c?c:null,this.onRejected="function"==typeof f?f:null,this.promise=a}function v(c,i){var a=!1;try{c(function(n){a||(a=!0,b(i,n))},function(n){a||(a=!0,p(i,n))})}catch(f){if(a){return}a=!0,p(i,f)}}var m=setTimeout;d.prototype["catch"]=function(a){return this.then(null,a)},d.prototype.then=function(c,a){var f=new this.constructor(g);return h(this,new l(c,a,f)),f},d.all=function(a){var c=Array.prototype.slice.call(a);return new d(function(u,n){function w(i,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o){return void o.call(e,function(r){w(i,r)},n)}}c[i]=e,0===--f&&u(c)}catch(t){n(t)}}if(0===c.length){return u([])}for(var f=c.length,s=0;s<c.length;s++){w(s,c[s])}})},d.resolve=function(a){return a&&"object"==typeof a&&a.constructor===d?a:new d(function(c){c(a)})},d.reject=function(a){return new d(function(e,c){c(a)})},d.race=function(a){return new d(function(r,e){for(var f=0,c=a.length;f<c;f++){a[f].then(r,e)}})},d._immediateFn="function"==typeof setImmediate&&function(a){setImmediate(a)}||function(a){m(a,0)},d._unhandledRejectionFn=function(a){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",a)},d._setImmediateFn=function(a){d._immediateFn=a},d._setUnhandledRejectionFn=function(a){d._unhandledRejectionFn=a},"undefined"!=typeof module&&module.exports?module.exports=d:k.Promise||(k.Promise=d)}(this);